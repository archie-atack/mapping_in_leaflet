[["index.html", "MLCSU R Guide Chapter 1 Mapping in Leaflet 1.1 Introduction 1.2 Libraries and Data 1.3 Background Tiles 1.4 Markers", " MLCSU R Guide Archie Atack 2023-10-05 Chapter 1 Mapping in Leaflet 1.1 Introduction Leaflet is a package in R that can create interactive maps. Most leaflet maps can be built out a few components: Markers Polygons Map tile background Legend Layer toggle The maps output as a html file which can be opened in a web browser and shared easily: The file can be shared via email Hosted on a sharepoint page - change the file extension from html to aspx and upload as a site owner Embedded within an R Markdown / Quarto document or Shiny dashboard The leaflet package is well documented and multiple examples can be found here: https://rstudio.github.io/leaflet/ 1.2 Libraries and Data The libraries used in the code below are: tidyverse leaflet sf - used to load spatial polygons of shapefiles (e.g. lower layer super output areas (LSOA) / ward shapefiles) crosstalk - to add map marker filters htmltools - to optimise the map functionality when using crosstalk Data included: Birmingham and Solihull ICS GP practices and acute providers including longitude / latitude co-ordinates. Index of multiple deprivation (IMD) deciles for LSOAs within BSOL BSOL LSOA and ward shapefiles library(tidyverse) library(leaflet) library(sf) library(crosstalk) library(htmltools) practices &lt;- read_csv(&quot;practices.csv&quot;) lsoa_data &lt;- read_csv(&quot;bsol_imd.csv&quot;) lsoa &lt;- st_read(&quot;lsoa.shp&quot;) wards &lt;- st_read(&quot;wards.shp&quot;) 1.3 Background Tiles A leaflet map begins with a leaflet function and each layer is added on top using the pipe operator (|&gt;). The addTiles() function adds a background map from OpenStreetMap. leaflet() |&gt; addTiles() 1.4 Markers Markers can be added to the map using the addAwesomeMarkers function. The customisation provided by addAwesomeMarkers makes it more useful than addMarkers. The below code maps 20 BSOL GP practices. leaflet() |&gt; addTiles() |&gt; addAwesomeMarkers( data = practices, lng = ~ Long, lat = ~ Lat, popup = ~ paste( &quot;Practice Name:&quot;, Practice_Name, &quot;&lt;br&gt;&lt;br&gt;&quot;, &quot;Population:&quot;, Population ) ) The data source, longitude, latitude, and pop-up (data to appear when the marker is clicked) arguments are defined. The tilde sign (~) is used to reduce repeated reference to the data source. In other words, it is rewriting “practices$Long” as “~Long”. HTML can be used within a paste (concatenate) function to format the popup text. A single &lt;br&gt; adds a line break. It is worth noting that as the co-ordinates were derived from postcodes, the markers will not exactly match the map underlay but will be in the correct general area. addCircleMarkers() is a useful alternative for visualising a numeric value of a marker. addCircleMarkers() provides the ability to adjust the marker radius and colour based upon a value. "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
